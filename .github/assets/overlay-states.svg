<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 200" width="700" height="200">
  <defs>
    <!-- Idle button shadow -->
    <filter id="idle-shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
    </filter>
    <!-- Recording glow -->
    <filter id="rec-glow" x="-40%" y="-40%" width="180%" height="180%">
      <feGaussianBlur in="SourceGraphic" stdDeviation="6" result="blur"/>
      <feColorMatrix in="blur" type="matrix" values="1 0 0 0 0.3  0 0.2 0 0 0  0 0 0.2 0 0  0 0 0 0.6 0" result="glow"/>
      <feMerge>
        <feMergeNode in="glow"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    <!-- Processing shadow -->
    <filter id="proc-shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
    </filter>
    <!-- Arrow marker -->
    <marker id="arr" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="7" markerHeight="7" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#81A1C1"/>
    </marker>

    <style>
      @keyframes pulse-ring {
        0%, 100% { r: 46; opacity: 0.3; }
        50% { r: 52; opacity: 0.15; }
      }
      @keyframes pulse-mic {
        0%, 100% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.15); opacity: 0.7; }
      }
      @keyframes bar-bounce {
        0%, 100% { transform: scaleY(1); opacity: 0.5; }
        50% { transform: scaleY(2); opacity: 1; }
      }
      @keyframes hover-glow {
        0%, 100% { opacity: 0; }
        50% { opacity: 0.08; }
      }
      .rec-ring { animation: pulse-ring 1.5s ease-in-out infinite; }
      .rec-mic { animation: pulse-mic 1.2s ease-in-out infinite; transform-origin: 350px 80px; }
      .bar-0 { animation: bar-bounce 0.8s ease-in-out 0s infinite; }
      .bar-1 { animation: bar-bounce 0.8s ease-in-out 0.15s infinite; }
      .bar-2 { animation: bar-bounce 0.8s ease-in-out 0.3s infinite; }
      .idle-hover { animation: hover-glow 3s ease-in-out infinite; }
    </style>
  </defs>

  <!-- ===================== IDLE STATE ===================== -->
  <g>
    <!-- Subtle hover glow -->
    <circle cx="120" cy="80" r="44" fill="#88C0D0" class="idle-hover"/>

    <!-- Button body: bg-surface-1, border-border -->
    <circle cx="120" cy="80" r="38" fill="#3B4252" stroke="#434C5E" stroke-width="2.5" filter="url(#idle-shadow)"/>

    <!-- Lucide Mic icon — text-primary (#88C0D0), w-7 h-7 (28px in 64px button)
         Lucide viewBox 24x24 → scale 1.25 to 30px, centered at (120, 80)
         transform: translate(cx-15, cy-15) scale(1.25) -->
    <g transform="translate(105, 65) scale(1.25)" fill="none" stroke="#88C0D0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/>
      <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
      <line x1="12" x2="12" y1="19" y2="22"/>
    </g>

    <!-- Label -->
    <text x="120" y="150" text-anchor="middle" fill="#D8DEE9" font-family="Segoe UI, system-ui, sans-serif" font-size="14" font-weight="500">Idle</text>
    <text x="120" y="168" text-anchor="middle" fill="#4C566A" font-family="Segoe UI, system-ui, sans-serif" font-size="11">Ready to record</text>
  </g>

  <!-- =================== RECORDING STATE =================== -->
  <g>
    <!-- Pulsing outer ring (audio level visualization) -->
    <circle cx="350" cy="80" r="46" fill="none" stroke="#BF616A" stroke-width="3" opacity="0.3" class="rec-ring"/>

    <!-- Button body: bg-destructive, border-destructive -->
    <circle cx="350" cy="80" r="38" fill="#BF616A" stroke="#BF616A" stroke-width="2.5" filter="url(#rec-glow)"/>

    <!-- Lucide Mic icon — text-destructive-foreground (#ECEFF4), pulsing
         Same geometry, centered at (350, 80) -->
    <g class="rec-mic" transform="translate(335, 65) scale(1.25)" fill="none" stroke="#ECEFF4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/>
      <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
      <line x1="12" x2="12" y1="19" y2="22"/>
    </g>

    <!-- Label -->
    <text x="350" y="150" text-anchor="middle" fill="#BF616A" font-family="Segoe UI, system-ui, sans-serif" font-size="14" font-weight="500">Recording</text>
    <text x="350" y="168" text-anchor="middle" fill="#4C566A" font-family="Segoe UI, system-ui, sans-serif" font-size="11">Listening to speech</text>
  </g>

  <!-- ================== PROCESSING STATE ================== -->
  <g>
    <!-- Button body: bg-surface-1, border-border-subtle -->
    <circle cx="580" cy="80" r="38" fill="#3B4252" stroke="#3B4252" stroke-width="2.5" filter="url(#proc-shadow)"/>

    <!-- LoadingDots — 3 bars, bg-foreground (#D8DEE9)
         Actual: width=3.5, height=6, gap=2, borderRadius=2
         Scaled 2x for diagram visibility: width=7, height=12, gap=4, rx=3
         Total width = 7*3 + 4*2 = 29, centered at cx=580
         Start x = 580 - 14.5 = 565.5, bars at y = 80-6 = 74 (centered vertically) -->
    <rect x="565.5" y="74" width="7" height="12" rx="3" fill="#D8DEE9" class="bar-0" style="transform-origin: 569px 80px"/>
    <rect x="576.5" y="74" width="7" height="12" rx="3" fill="#D8DEE9" class="bar-1" style="transform-origin: 580px 80px"/>
    <rect x="587.5" y="74" width="7" height="12" rx="3" fill="#D8DEE9" class="bar-2" style="transform-origin: 591px 80px"/>

    <!-- Label -->
    <text x="580" y="150" text-anchor="middle" fill="#EBCB8B" font-family="Segoe UI, system-ui, sans-serif" font-size="14" font-weight="500">Processing</text>
    <text x="580" y="168" text-anchor="middle" fill="#4C566A" font-family="Segoe UI, system-ui, sans-serif" font-size="11">Transcribing &amp; enhancing</text>
  </g>

  <!-- Arrows between states -->
  <line x1="170" y1="80" x2="295" y2="80" stroke="#81A1C1" stroke-width="1.5" stroke-dasharray="5,4" marker-end="url(#arr)"/>
  <text x="232" y="72" text-anchor="middle" fill="#81A1C1" font-family="Segoe UI, system-ui, sans-serif" font-size="10">click / hotkey</text>

  <line x1="400" y1="80" x2="525" y2="80" stroke="#81A1C1" stroke-width="1.5" stroke-dasharray="5,4" marker-end="url(#arr)"/>
  <text x="462" y="72" text-anchor="middle" fill="#81A1C1" font-family="Segoe UI, system-ui, sans-serif" font-size="10">stop</text>
</svg>
